<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aventura Educativa - Juego de Preguntas</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@400;700&family=Fredoka+One&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="original/css/styles.css">
    <link rel="stylesheet" href="original/css/animations.css">
</head>
<body class="min-h-screen flex flex-col">
    <!-- Pantalla de bienvenida y registro de nickname -->
    <div id="pantalla-bienvenida" class="screen fixed inset-0 z-50 flex flex-col items-center justify-center bg-gradient-to-br from-indigo-200 via-white to-pink-200 min-h-screen overflow-hidden">
        <canvas id="particles-bg" class="absolute inset-0 w-full h-full pointer-events-none z-0"></canvas>
        <div class="relative z-10 bg-white rounded-2xl shadow-2xl p-4 sm:p-6 md:p-8 max-w-lg w-full flex flex-col items-center max-h-[90vh] overflow-y-auto">
            <h1 class="text-4xl md:text-5xl font-bold text-indigo-600 mb-4 text-center">¬°Bienvenido a la Aventura Educativa!</h1>
            <p class="text-lg text-gray-700 mb-6 text-center">Reg√≠strate con tu nickname para comenzar a jugar y compite en el ranking.</p>
            <form id="form-nickname" class="flex flex-col items-center gap-4 mb-6 w-full">
                <input id="input-nickname" type="text" maxlength="16" placeholder="Tu nickname" class="border-2 border-indigo-300 rounded-lg px-4 py-2 w-full focus:outline-none focus:ring-2 focus:ring-indigo-400 text-center text-lg" required>
                <div class="flex flex-col w-full gap-2">
                    <label class="text-indigo-700 font-bold text-center">Selecciona tu g√©nero üë¶/üëß</label>
                    <div class="flex justify-center gap-4">
                        <label class="flex flex-col items-center cursor-pointer">
                            <span class="text-3xl">‚ôÇÔ∏è</span>
                            <input type="radio" name="genero" value="masculino" class="mt-1" required>
                            <span class="text-xs">Masculino</span>
                        </label>
                        <label class="flex flex-col items-center cursor-pointer">
                            <span class="text-3xl">‚ôÄÔ∏è</span>
                            <input type="radio" name="genero" value="femenino" class="mt-1" required>
                            <span class="text-xs">Femenino</span>
                        </label>
                        <label class="flex flex-col items-center cursor-pointer">
                            <span class="text-3xl">ü¶†</span>
                            <input type="radio" name="genero" value="otro" class="mt-1" required>
                            <span class="text-xs">Otro</span>
                        </label>
                    </div>
                </div>
                <div class="w-full mt-4 p-4 bg-indigo-50 rounded-lg shadow-inner">
                    <label class="block text-indigo-700 font-bold mb-2 text-center">¬°Dise√±a tu avatar!</label>
                    <div class="flex flex-col md:flex-row gap-4 items-center justify-center">
                        <div id="avatar-preview" class="flex flex-col items-center">
                            <svg id="avatar-svg" width="80" height="80" viewBox="0 0 80 80"></svg>
                            <span class="text-xs mt-1">Vista previa</span>
                        </div>
                        <div class="flex flex-col gap-2">
                            <label class="text-xs">Color de piel:
                                <input type="color" id="avatar-skin" value="#fcd7b6" class="ml-2">
                            </label>
                            <label class="text-xs">Color de pelo:
                                <input type="color" id="avatar-hair" value="#3e2723" class="ml-2">
                            </label>
                            <label class="text-xs">Forma de cara:
                                <select id="avatar-face" class="ml-2">
                                    <option value="normal">Normal</option>
                                    <option value="gordo">Gordo</option>
                                    <option value="flaco">Flaco</option>
                                    <option value="femenino">M√°s femenino</option>
                                    <option value="masculino">M√°s masculino</option>
                                </select>
                            </label>
                        </div>
                    </div>
                </div>
                <button type="submit" class="btn-jugar px-6 py-2 rounded-lg text-white font-bold bg-indigo-500 hover:bg-indigo-700 transition-all mt-2">Entrar</button>
            </form>
            <div id="ranking-container" class="mb-4 w-full">
                <h2 class="text-2xl font-bold text-indigo-700 mb-2 text-center">Ranking de Jugadores</h2>
                <div class="max-h-40 sm:max-h-56 md:max-h-64 overflow-y-auto rounded-lg border border-indigo-100 bg-indigo-50/40 shadow-inner">
                    <ul id="lista-ranking" class="divide-y divide-indigo-100 text-lg"></ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal personalizado -->
    <div id="modal-mensaje" class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40 hidden">
        <div class="bg-white rounded-xl shadow-2xl p-8 max-w-md w-full text-center">
            <h2 id="modal-titulo" class="text-2xl font-bold mb-4 text-indigo-600"></h2>
            <p id="modal-texto" class="text-lg mb-6 text-gray-700"></p>
            <button id="modal-cerrar" class="btn-jugar px-6 py-2 rounded-lg text-white font-bold bg-indigo-500 hover:bg-indigo-700">Cerrar</button>
        </div>
    </div>

    <!-- Pantalla de inicio (selecci√≥n de grado) -->
    <div id="inicio" class="screen py-12 px-4 text-center hidden relative overflow-hidden min-h-screen flex flex-col items-center justify-center">
        <canvas id="particles-bg-grados" class="absolute inset-0 w-full h-full pointer-events-none z-0"></canvas>
        <div class="max-w-5xl mx-auto relative z-10 w-full">
            <div class="flex flex-col md:flex-row items-center justify-between gap-8">
                <div class="flex-1 flex flex-col items-center md:items-start">
                    <h1 class="titulo text-5xl md:text-6xl mb-4 text-indigo-700 font-extrabold drop-shadow-lg">¬°Elige tu Grado!</h1>
                    <p class="text-xl mb-6 text-gray-700 font-semibold">Cada grado es un mundo de aventuras. ¬°Desbloquea logros y colecciona medallas!</p>
                </div>
                <div class="flex-1 flex flex-col items-center">
                    <div id="perfil-jugador" class="mb-4"></div>
                </div>
            </div>
            <div class="mt-10">
                <div class="flex flex-wrap justify-center gap-8" id="grados-container"></div>
            </div>
        </div>
    </div>

    <!-- Pantalla de selecci√≥n de materia -->
    <div id="seleccion-materia" class="screen hidden py-12 px-4">
        <div class="max-w-4xl mx-auto">
            <button onclick="volverAGrados()" class="mb-6 flex items-center text-indigo-600 hover:text-indigo-800">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
                </svg>
                Volver a grados
            </button>
            <h2 id="titulo-grado" class="titulo text-4xl mb-8 text-center"></h2>
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6"></div>
        </div>
    </div>

    <!-- Pantalla de selecci√≥n de competencia (A√ëADIR DESPU√âS DE seleccion-materia en el HTML principal) -->
    <div id="seleccion-competencia" class="screen hidden py-12 px-4">
        <div class="max-w-4xl mx-auto">
            <button onclick="volverAMaterias()" class="mb-6 flex items-center text-indigo-600 hover:text-indigo-800">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
                </svg>
                Volver a materias
            </button>
            
            <h2 id="titulo-materia-competencia" class="titulo text-4xl mb-8 text-center"></h2>
            
            <div class="mb-6 p-4 bg-indigo-50 rounded-lg">
                <p class="text-center text-gray-700">
                    <span class="font-bold text-indigo-700">üí° Selecciona una competencia</span><br>
                    Cada competencia agrupa preguntas relacionadas con un tema espec√≠fico
                </p>
            </div>
            
            <div id="competencias-container" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Las competencias se renderizan din√°micamente aqu√≠ -->
            </div>
        </div>
    </div>

    <!-- Pantalla de juego -->
    <div id="juego" class="screen hidden py-12 px-4">
        <div class="max-w-4xl mx-auto">
            <div class="flex justify-between items-center mb-8">
                <button onclick="volverAMaterias()" class="flex items-center text-indigo-600 hover:text-indigo-800">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
                    </svg>
                    Cambiar materia
                </button>
                <div class="flex items-center">
                    <span id="puntuacion" class="text-2xl font-bold mr-4">0 pts</span>
                    <div class="w-40 bg-gray-200 rounded-full h-4">
                        <div id="barra-progreso" class="bg-green-500 h-4 rounded-full" style="width: 0%"></div>
                    </div>
                </div>
            </div>
            <div id="info-juego" class="mb-6 p-4 bg-white rounded-lg shadow">
                <h2 id="materia-actual" class="text-2xl font-bold"></h2>
                <p id="grado-actual" class="text-gray-600"></p>
            </div>
            <div id="feedback-container" class="hidden mt-6 p-4 bg-white rounded-lg shadow-lg">
                <p id="feedback-texto" class="text-xl mb-4"></p>
                <img id="feedback-imagen" src="" alt="Retroalimentaci√≥n" class="w-20 h-20">
            </div>
            <div id="pregunta-container" class="p-6 bg-white rounded-xl shadow-lg pregunta-container">
                <h3 id="pregunta-texto" class="text-xl font-bold mb-6"></h3>
                <div id="opciones-container" class="grid grid-cols-1 md:grid-cols-2 gap-4"></div>
            </div>

        </div>
    </div>

    <!-- Pantalla de resultados -->
    <div id="resultados" class="screen hidden py-12 px-4">
        <div class="max-w-4xl mx-auto text-center">
            <h2 class="titulo text-4xl mb-8">¬°Resultados Finales!</h2>
            <div id="resultado-contenido" class="bg-white rounded-xl p-8 shadow-xl max-w-2xl mx-auto">
                <img src="https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/3d73f586-248a-4a29-bfa6-f4d2a3c4677b.png" alt="Celebraci√≥n" class="mx-auto mb-6">
                <h3 id="resultado-titulo" class="text-2xl font-bold mb-4"></h3>
                <p id="resultado-puntuacion" class="text-xl mb-6"></p>
                <p id="resultado-mensaje" class="text-lg mb-8"></p>
                <div class="flex flex-col sm:flex-row justify-center gap-4">
                    <button onclick="volverAGrados()" class="btn-jugar px-6 py-3 rounded-lg text-white font-bold">Elegir otro grado</button>
                    <button onclick="repetirMateria()" class="btn-jugar px-6 py-3 rounded-lg text-white font-bold bg-indigo-500">Repetir materia</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="original/js/preguntas.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    
    <!-- Scripts modulares en orden de dependencias -->
    <script src="original/js/storage.js"></script>
    <script src="original/js/utils.js"></script>
    <script src="original/js/audio.js"></script>
    <script src="original/js/avatar.js"></script>
    <script src="original/js/ui.js"></script>
    <script src="original/js/render.js"></script>
    <script src="original/js/dificultad.js"></script>
    <script src="original/js/game.js"></script>
    <script src="original/js/init.js"></script>

    <script src="original/js/particulas.js"></script>
</body>
</html>